<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rgrids">
<title>Submatrices and lists of matrices • rgrids</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Submatrices and lists of matrices">
<meta property="og:description" content="rgrids">
<meta property="og:image" content="https://leonardo-bo.github.io/rgrids/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rgrids</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/df-matrices.html">dataframes &lt;==&gt; matrices</a>
    <a class="dropdown-item" href="../articles/grids1d.html">1D grids</a>
    <a class="dropdown-item" href="../articles/grids2d.html">2D grids</a>
    <a class="dropdown-item" href="../articles/matrices.html">Submatrices and lists of matrices</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Leonardo-Bo/rgrids/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="matrices_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Submatrices and lists of matrices</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Leonardo-Bo/rgrids/blob/HEAD/vignettes/matrices.Rmd" class="external-link"><code>vignettes/matrices.Rmd</code></a></small>
      <div class="d-none name"><code>matrices.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Leonardo-Bo/rgrids" class="external-link">rgrids</a></span><span class="op">)</span></code></pre></div>
<p>This vignette shows an easy way to work with submatrices and matrix lists.</p>
<p>The following functions apply to both rectangular and square matrices. In data analysis, a square matrix can emerge, for example, from covariance calculations, or by calculating the distances between all the points belonging to a given set;</p>
<pre><code>(A, B, C)

   A  B  C
A  x  x  x
B  x  x  x
C  x  x  x</code></pre>
<p>a rectangular matrix instead can still emerge between distance calculations, but between two sets with different number of points.</p>
<pre><code>(A, B, C)
(D, E)

   A  B  C
D  x  x  x
E  x  x  x</code></pre>
<div class="section level2">
<h2 id="basic-operations-mean-max-min">Basic operations: mean, max, min<a class="anchor" aria-label="anchor" href="#basic-operations-mean-max-min"></a>
</h2>
<p>Given a matrix, it may be useful to consider its blocks and observe some essential characteristics of each block. To do this you can use the <code><a href="../reference/blockmean.html">blockmean()</a></code>, <code><a href="../reference/blockmax.html">blockmax()</a></code> and <code><a href="../reference/blockmin.html">blockmin()</a></code> functions that take a matrix and the block size as input and return the average, maximum and minimum values of each block respectively.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">mat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">64</span>, nrow <span class="op">=</span> <span class="fl">8</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]</span>
<span class="co">#&gt; [1,]    1    2    3    4    5    6    7    8</span>
<span class="co">#&gt; [2,]    9   10   11   12   13   14   15   16</span>
<span class="co">#&gt; [3,]   17   18   19   20   21   22   23   24</span>
<span class="co">#&gt; [4,]   25   26   27   28   29   30   31   32</span>
<span class="co">#&gt; [5,]   33   34   35   36   37   38   39   40</span>
<span class="co">#&gt; [6,]   41   42   43   44   45   46   47   48</span>
<span class="co">#&gt; [7,]   49   50   51   52   53   54   55   56</span>
<span class="co">#&gt; [8,]   57   58   59   60   61   62   63   64</span></code></pre></div>
<p>It is important that the blocks fill the entire matrix, that is, that the total number of rows and columns is a multiple of the number of rows and columns in the block. In this case, for example, blocks of size <code>c(2,4)</code>, <code>c(4,2)</code> and so on are good. While it is possible to work with rectangular blocks, it is very often useful to work with square blocks. For example we define a 2x2 block and apply the functions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/blockmean.html">blockmean</a></span><span class="op">(</span><span class="va">mat1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]  5.5  7.5  9.5 11.5</span>
<span class="co">#&gt; [2,] 21.5 23.5 25.5 27.5</span>
<span class="co">#&gt; [3,] 37.5 39.5 41.5 43.5</span>
<span class="co">#&gt; [4,] 53.5 55.5 57.5 59.5</span>

<span class="fu"><a href="../reference/blockmax.html">blockmax</a></span><span class="op">(</span><span class="va">mat1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]   10   12   14   16</span>
<span class="co">#&gt; [2,]   26   28   30   32</span>
<span class="co">#&gt; [3,]   42   44   46   48</span>
<span class="co">#&gt; [4,]   58   60   62   64</span>

<span class="fu"><a href="../reference/blockmin.html">blockmin</a></span><span class="op">(</span><span class="va">mat1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]    1    3    5    7</span>
<span class="co">#&gt; [2,]   17   19   21   23</span>
<span class="co">#&gt; [3,]   33   35   37   39</span>
<span class="co">#&gt; [4,]   49   51   53   55</span></code></pre></div>
<p>If the block is square it is sufficient to insert only one dimension, while for a rectangular block a vector <code>c(nrow_block, ncol_block)</code> must be passed.</p>
<div class="section level3">
<h3 id="lists-of-submatrices">Lists of submatrices<a class="anchor" aria-label="anchor" href="#lists-of-submatrices"></a>
</h3>
<p>In some situations it may be necessary to perform more complex operations on the blocks.</p>
<p>Suppose we want to multiply each block by a different integer. To do this it is convenient to have control over each block. We can collect all submatrices in one list using <code><a href="../reference/blocklist.html">blocklist()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">list_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blocklist.html">blocklist</a></span><span class="op">(</span><span class="va">mat1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $`1`</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]    1    2    3    4</span>
<span class="co">#&gt; [2,]    9   10   11   12</span>
<span class="co">#&gt; [3,]   17   18   19   20</span>
<span class="co">#&gt; [4,]   25   26   27   28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2`</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]    5    6    7    8</span>
<span class="co">#&gt; [2,]   13   14   15   16</span>
<span class="co">#&gt; [3,]   21   22   23   24</span>
<span class="co">#&gt; [4,]   29   30   31   32</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`3`</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]   33   34   35   36</span>
<span class="co">#&gt; [2,]   41   42   43   44</span>
<span class="co">#&gt; [3,]   49   50   51   52</span>
<span class="co">#&gt; [4,]   57   58   59   60</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`4`</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]   37   38   39   40</span>
<span class="co">#&gt; [2,]   45   46   47   48</span>
<span class="co">#&gt; [3,]   53   54   55   56</span>
<span class="co">#&gt; [4,]   61   62   63   64</span></code></pre></div>
<p>Like the previous functions, <code><a href="../reference/blocklist.html">blocklist()</a></code> takes the matrix and the size of the block as input.</p>
<p>An element of the list can be accessed with a double square bracket: <code>list_matrix[[i]]</code>; however, often for operations on lists it is possible to avoid having to access each element individually thanks to the <code>lapply</code> function.</p>
<p>We multiply each matrix in the list by a different number: the first by <code>4</code>, the second by <code>9</code>, the third by <code>16</code> and the fourth by <code>25</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">l</span>, <span class="va">v</span><span class="op">)</span> <span class="va">l</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="va">v</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">list_matrix</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">16</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]    4    8   12   16</span>
<span class="co">#&gt; [2,]   36   40   44   48</span>
<span class="co">#&gt; [3,]   68   72   76   80</span>
<span class="co">#&gt; [4,]  100  104  108  112</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]   45   54   63   72</span>
<span class="co">#&gt; [2,]  117  126  135  144</span>
<span class="co">#&gt; [3,]  189  198  207  216</span>
<span class="co">#&gt; [4,]  261  270  279  288</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]  528  544  560  576</span>
<span class="co">#&gt; [2,]  656  672  688  704</span>
<span class="co">#&gt; [3,]  784  800  816  832</span>
<span class="co">#&gt; [4,]  912  928  944  960</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]  925  950  975 1000</span>
<span class="co">#&gt; [2,] 1125 1150 1175 1200</span>
<span class="co">#&gt; [3,] 1325 1350 1375 1400</span>
<span class="co">#&gt; [4,] 1525 1550 1575 1600</span></code></pre></div>
<div class="section level4">
<h4 id="dblocklist">dblocklist<a class="anchor" aria-label="anchor" href="#dblocklist"></a>
</h4>
<p>The block diagonal of a matrix can be more importante than the off-diagonal blocks. You can collect the diagonal blocks in a list using the <code><a href="../reference/dblocklist.html">dblocklist()</a></code> function analogous to <code><a href="../reference/blocklist.html">blocklist()</a></code>. The only trick: the blocks must fill the diagonal. This mathematically translates into the fact that the ratio between the number of rows in the matrix and the number of rows in the block must be equal to the ratio between the number of columns in the matrix and the number of columns in the block. Example: for a 16x8 matrix <code><a href="../reference/dblocklist.html">dblocklist()</a></code> accepts 8x4, 4x2 blocks.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/dblocklist.html">dblocklist</a></span><span class="op">(</span><span class="va">mat1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; $`1`</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]    1    2</span>
<span class="co">#&gt; [2,]    9   10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2`</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]   19   20</span>
<span class="co">#&gt; [2,]   27   28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`3`</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]   37   38</span>
<span class="co">#&gt; [2,]   45   46</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`4`</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]   55   56</span>
<span class="co">#&gt; [2,]   63   64</span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="from-list-of-matrices-to-single-matrix">From list of matrices to single matrix<a class="anchor" aria-label="anchor" href="#from-list-of-matrices-to-single-matrix"></a>
</h2>
<p>Suppose we need to calculate the mean distance over time between all pairs of two sets of points. For convenience we use <code>list_matrix</code>: each matrix <span class="math inline">\(k\)</span> in the list is a set of distances at time <span class="math inline">\(t_k\)</span>.</p>
<p>The <code><a href="../reference/meanMatrix.html">meanMatrix()</a></code> function returns the mean of each element <span class="math inline">\((i, j)\)</span> of matrix</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/meanMatrix.html">meanMatrix</a></span><span class="op">(</span><span class="va">list_matrix</span><span class="op">)</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]   19   20   21   22</span>
<span class="co">#&gt; [2,]   27   28   29   30</span>
<span class="co">#&gt; [3,]   35   36   37   38</span>
<span class="co">#&gt; [4,]   43   44   45   46</span></code></pre></div>
<p>Similarly, <code><a href="../reference/sumMatrix.html">sumMatrix()</a></code> and <code><a href="../reference/dotMatrix.html">dotMatrix()</a></code> functions return sum and product of each element <span class="math inline">\((i, j)\)</span> of matrix of the list</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sumMatrix.html">sumMatrix</a></span><span class="op">(</span><span class="va">list_matrix</span><span class="op">)</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]   76   80   84   88</span>
<span class="co">#&gt; [2,]  108  112  116  120</span>
<span class="co">#&gt; [3,]  140  144  148  152</span>
<span class="co">#&gt; [4,]  172  176  180  184</span>

<span class="fu"><a href="../reference/dotMatrix.html">dotMatrix</a></span><span class="op">(</span><span class="va">list_matrix</span><span class="op">)</span>
<span class="co">#&gt;         [,1]    [,2]    [,3]    [,4]</span>
<span class="co">#&gt; [1,]    6105   15504   28665   46080</span>
<span class="co">#&gt; [2,]  215865  270480  333465  405504</span>
<span class="co">#&gt; [3,]  927129 1069200 1225785 1397760</span>
<span class="co">#&gt; [4,] 2520825 2804880 3111129 3440640</span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Leonardo Bò.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
